CREATE OR REPLACE VIEW ILA_VW_USUARIO AS
SELECT
  ID_CODUSUARIO,
  TX_USERNAME,
  TX_NOMEUSUARIO,
  TX_APELIDO,
  TX_EMPRESA,
  ID_MIX,
  MATRICULA,
  MATRICULA_ANTIGA,
  TX_MATRIC_ALTERNATIVA,
  TX_SIGLA_AREA,
  TX_ESTRUTURA,
  DT_NASCIMENTO,
  DT_ADMISSAO,
  DT_DEMISSAO,
  DT_ATUALIZACAO,
  DT_EXPIRACAO,
  DT_DESLIGAMENTO_TERCEIRO,
  CPF,
  RG,
  CD_FUNCIONARIO,
  CD_TIPO_FUNCIONARIO,
  TX_TIPO_FUNCIONARIO,
  TX_SITE,
  TX_BILHETE_SERVICO,
  ID_CARGO,
  TX_CARGO,
  ID_FUNCAO,
  TX_FUNCAO,
  CD_SEXO,
  TX_TELEFONE,
  TX_TELEFONE_CELULAR,
  TX_FAX,
  TX_ENDERECO,
  TX_CEP,
  TX_CIDADE,
  TX_ESTADO,
  TX_EMAIL,
  ID_CODUSUARIO_GESTOR_AD,
  CD_STATUS_EMPREGADO,
  TX_STATUS_EMPREGADO,
  ID_CHEFE_PONTO,
  TX_TIPO_CHEFE,
  FL_EMPREGADO,
  FL_ATIVO,
  FL_ATIVO_AD,
  FL_ATV_NRM
FROM
  CPU.CPU_VW_USUARIOS_ILA;
/

ALTER VIEW ILA_VW_USUARIO
  ADD CONSTRAINT PK_VW_USUARIO PRIMARY KEY (ID_CODUSUARIO)
  DISABLE;
/

CREATE OR REPLACE VIEW ILA_VW_USUARIO_FOTO AS
SELECT * FROM CPU.CPU_VW_USUARIOS_FOTO_ILA;
/

ALTER VIEW ILA_VW_USUARIO_FOTO
  ADD CONSTRAINT PK_VW_USUARIO_FOTO PRIMARY KEY (ID_CODUSUARIO)
  DISABLE;
/

CREATE OR REPLACE VIEW ILA_VW_ESTRUTURA_ORG AS
SELECT 
       ID_ESTRUTURA,
       TX_NOME,
       TX_NOME_REDUZIDO,
       TX_LOGRADOURO,
       TX_NUMERO,
       TX_COMPLEMENTO,
       CD_CENTRO_CUSTO,
       TX_BAIRRO,
       TX_CIDADE,
       TX_ESTADO,
       TX_ENDERECO_COMPLETO,
       TX_SIGLA,
       NR_NIVEL,
       DEP_SIGLA,
       GER_SIGLA,
       GG_SIGLA,
       DIR_SIGLA,
       CD_TIPO_ESTRUTURA,
	   TX_TIPO_ESTRUTURA,
       FL_ATIVO
  FROM CPU.CPU_VW_ESTRUTURA_ORG_ILA EO;
/

ALTER VIEW ILA_VW_ESTRUTURA_ORG
  ADD CONSTRAINT PK_VW_ESTRUTURA_ORG PRIMARY KEY (ID_ESTRUTURA)
  DISABLE;
/

CREATE OR REPLACE VIEW ILA_VW_CASIS_GRUPO AS
SELECT ID_SISTEMA,TX_SIGLA,ID_GRUPO,TX_DESCR_GRUPO FROM CASIS.CASIS_VW_SISTEMA_GRUPO G WHERE G.TX_SIGLA = 'ILA';
/

ALTER VIEW ILA_VW_CASIS_GRUPO
  ADD CONSTRAINT PK_VW_CASIS_GRUPO PRIMARY KEY (ID_GRUPO)
  DISABLE;
/

CREATE OR REPLACE VIEW ILA_VW_CASIS_GRUPO_USUARIO AS
SELECT ID_GRUPO, ID_USUARIO AS ID_CODUSUARIO
FROM CASIS.CASIS_VW_USUARIOS_AUTORIZADOS G
WHERE G.ID_GRUPO IN (SELECT ID_GRUPO FROM CASIS.CASIS_VW_SISTEMA_GRUPO WHERE TX_SIGLA = 'ILA');
/

ALTER VIEW ILA_VW_CASIS_GRUPO_USUARIO
  ADD CONSTRAINT PK_VW_CASIS_GRUPO_USUARIO PRIMARY KEY (ID_GRUPO, ID_CODUSUARIO)
  DISABLE;
/

CREATE OR REPLACE VIEW ILA_VW_CARGO AS
SELECT DISTINCT
       ID_CARGO, TX_CARGO, FL_ATIVO
FROM
       CPU.CPU_VW_CARGO_ILA;
/
ALTER VIEW ILA_VW_CARGO
  ADD CONSTRAINT PK_VW_CARGO PRIMARY KEY (ID_CARGO)
  DISABLE;
/

CREATE OR REPLACE VIEW ILA_VW_FUNCAO AS
SELECT DISTINCT
       ID_FUNCAO, TX_FUNCAO, FL_ATIVO
FROM
       CPU.CPU_VW_FUNCAO_ILA;
/
ALTER VIEW ILA_VW_FUNCAO
  ADD CONSTRAINT PK_VW_FUNCAO PRIMARY KEY (ID_FUNCAO)
  DISABLE;
/

