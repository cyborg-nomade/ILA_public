CREATE OR REPLACE VIEW CPU_VW_USUARIOS_ILA AS
SELECT ID_CODUSUARIO,
       TX_USERNAME,
       FL_CTRSENHA,
       FL_ATIVO,
       TX_NOMEUSUARIO,
       TX_APELIDO,
       TX_SENHA,
       TX_DESCRICAO,
       TX_EMPRESA,
       CD_USUARIO AS ID_MIX,
       MATRICULA,
       TX_SIGLA_AREA,
       DECODE(U.TX_ESTRUTURA,NULL, U.TX_ESTRUT_ALTER,U.TX_ESTRUTURA) TX_ESTRUTURA,
       ID_RESP,
       CONTRATO,
       DEMISSAO AS DT_DEMISSAO,
       CPF,
       RG,
       DATA_NASCIMENTO AS DT_NASCIMENTO,
       DT_ADMISSAO,
       DT_ATUALIZA AS DT_ATUALIZACAO,       
       COD_FUNC AS CD_FUNCIONARIO,
       TIPO_FUNCIONARIO AS CD_TIPO_FUNCIONARIO,
       TX_TIPO_FUNCIONARIO,
       DATA_EXPIRACAO_USU AS DT_EXPIRACAO,
       SITE AS TX_SITE,
       DT_DESLIGAMENTO_TERCEIRO,
       BILHETE_SERVICO AS TX_BILHETE_SERVICO,
       MATRICULA_ANTIGA,
       TX_MATRIC_ALTER AS TX_MATRIC_ALTERNATIVA,
       TX_EMAIL,
       ID_CHEFE_PONTO,
       TX_TIPO_CHEFE,
       FL_ATV_NRM,
       ID_CARGO,
       DES_CARGO AS TX_CARGO,
       ID_FUNCAO,
       TX_DESC_FCN AS TX_FUNCAO,
       CD_CRACHA,
       TX_SEXO AS CD_SEXO,
       FL_EMPREGADO,
       TELEFONE AS TX_TELEFONE,
       TELEFONE_CELULAR AS TX_TELEFONE_CELULAR,
       FAX AS TX_FAX,
       TX_ENDERECO,
       TX_CEP,
       TX_CIDADE,
       TX_ESTADO,
       FL_PENDENTE_ATUALIZACAO_AD,
       FL_PENDENTE_ATUALIZACAO_MIX,
       FL_PENDENTE_ATUALIZACAO_APOLO,
       ID_CODUSUARIO_GESTOR_AD,
       TX_NOME_DISTINTO_AD,
       CD_OBJECT_GUID_AD,
       ID_SINCRONISMO,
       CD_STATUS_EMPREGADO,
       TX_STATUS_EMPREGADO,
       FL_ATIVO_AD
  FROM
       USUARIOS U;
/

CREATE OR REPLACE VIEW CPU_VW_USUARIOS_FOTO_ILA AS
SELECT
  U.ID_CODUSUARIO
  ,U.FOTO
  ,U.FL_TRATADA
FROM
  CPU.USUARIOS_FOTO U
;
/

CREATE OR REPLACE VIEW CPU_VW_ESTRUTURA_ORG_ILA AS
SELECT
  EO.ES_ID_ESTRUTURA AS ID_ESTRUTURA,
  EO.ES_RAZAO_SOCIAL AS TX_NOME,
  EO.ES_NOME AS TX_NOME_REDUZIDO,
  EO.ES_LOGRADOURO AS TX_LOGRADOURO,
  EO.ES_NUMERO AS TX_NUMERO,
  EO.ES_COMPLEMENTO AS TX_COMPLEMENTO,
  EO.CCU_CODIGO AS CD_CENTRO_CUSTO,
  EO.BA_NOME AS TX_BAIRRO,
  EO.CI_NOME AS TX_CIDADE,
  EO.UF_SIGLA AS TX_ESTADO,
  EO.ES_LOGRADOURO || ', ' || EO.ES_NUMERO || ' - ' || EO.ES_COMPLEMENTO || ' - ' || EO.BA_NOME || ' - ' || EO.CI_NOME || ' / ' || EO.UF_SIGLA AS TX_ENDERECO_COMPLETO,
  EO.ES_SIGLA AS TX_SIGLA,
  (
     CASE
       WHEN EO.SIGLA_ESTRUTURA IS NULL AND DEP_SIGLA IS NULL AND GER_SIGLA IS NULL AND GG_SIGLA IS NULL AND DIR_SIGLA IS NULL THEN 0
       WHEN EO.SIGLA_ESTRUTURA = DIR_SIGLA THEN 1
       WHEN EO.SIGLA_ESTRUTURA = GG_SIGLA THEN 2
       WHEN EO.SIGLA_ESTRUTURA = GER_SIGLA THEN 3
       WHEN EO.SIGLA_ESTRUTURA = DEP_SIGLA THEN 4
       ELSE 5
     END
  ) AS NR_NIVEL,
  EO.DEP_SIGLA,
  EO.GER_SIGLA,
  EO.GG_SIGLA,
  EO.DIR_SIGLA,
  EO.ES_TIPO AS CD_TIPO_ESTRUTURA,
  EO.ES_TIPO_DESCR AS TX_TIPO_ESTRUTURA,
  DECODE(EO.ES_ATIVA,'S', 1, 0) AS FL_ATIVO
FROM
  CPU.ESTRUTURA_ORG EO
ORDER BY
  EO.ES_ID_ESTRUTURA;
/

CREATE OR REPLACE VIEW CPU_VW_FUNCAO_ILA AS
SELECT
  F.ID_FUNCAO, F.TX_DESCR_FCN AS TX_FUNCAO, F.FL_ATIVO
FROM
  FUNCAO F;
/

CREATE OR REPLACE VIEW CPU_VW_CARGO_ILA AS
SELECT
  C.ID_CARGO, C.TX_CARGO_RED AS TX_CARGO_REDUZIDO, C.TX_CARGO_DESC AS TX_CARGO, C.FL_ATIVO
FROM
  CARGO C;
/

GRANT SELECT ON CPU.CPU_VW_USUARIOS_ILA TO ILA WITH GRANT OPTION;
GRANT SELECT ON CPU.CPU_VW_USUARIOS_FOTO_ILA TO ILA WITH GRANT OPTION;
GRANT SELECT ON CPU.CPU_VW_ESTRUTURA_ORG_ILA TO ILA WITH GRANT OPTION;
GRANT SELECT ON CPU.CPU_VW_FUNCAO_ILA TO ILA WITH GRANT OPTION;
GRANT SELECT ON CPU.CPU_VW_CARGO_ILA TO ILA WITH GRANT OPTION;
